{ connectPortsToBuses } = require '../adapter/exports'
linkTogetherMVC         = require './linkTogetherMVC'
{ push }                = require '../controller/exports'
render                  = require '../react/render'
{ setAppState }         = require '../appstate-utilities'

initialize = (appNodeID, topViewFactory, initialAppState, viewImports) ->
  setAppState { appNodeID, topViewFactory }
  topReactDescriptor = linkTogetherMVC (topViewFactory, initialAppState)
  render (topReactDescriptor, (document.getElementById appNodeID))
  connectPortsToBuses viewImports

module.exports = initialize
